<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <title>我的钱包</title>
    <link rel="stylesheet" href="__CSS__/common.css"/>
    <link rel="stylesheet" href="__CSS__/wallet.css"/>
    <link href="__PUBLIC__/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	
	<!--演示页面样式，使用时可以不引用-->
	<link rel="stylesheet" type="text/css" href="__CSS__/demo.css">
	<link rel="stylesheet" href="__PUBLIC__/bootstrap/css/icheck-bootstrap.css">
    <script type="text/javascript" src="__PUBLIC__/jquery/jquery-latest.js"></script>
    <script type="text/javascript">
        function fontSize(){
            var deviceWidth=document.documentElement.clientWidth>768?768:document.documentElement.clientWidth;
            document.documentElement.style.fontSize=(deviceWidth/25)+"px";
        }
        fontSize();
        window.onresize=fontSize;
    </script>
</head>
<body>


 <div class="login_bg">
        <div class="logo"><img src="__IMG__/logo1.png"></div>
        
        {include file='publish/back'}
        
        <div class="topright">
        		
                <div class="box1">账号：{notempty name='member'}{$member.user_name}{else /}未登录{/notempty}</div>
                
                <div class="box1">荣誉级别：{notempty name='$member.level'}{$member.level|level}{else /}无{/notempty}</div>
                
                <div class="box1">钱包等级：{notempty name='$member.grade'}{$member.grade|grade}{else /}一级钱包{/notempty}</div>
                
                <div class="box1">账户状态：{notempty name='$member.status'}{if condition="$member.status==1"}已激活{else /}未激活{/if}{else /}未激活{/notempty}</div>      
       
        </div>
        
        {include file="publish/topbom"}
        <!-- 内容 -->
    <div class="body-box">
            <div class="row wallet">
                    <div class="col-sm-6 col-md-4">
                      <div class="thumbnail">
                            <p><a href="#" class="btn btn-primary" role="button">金币</a>&nbsp;&nbsp;交易记录</p>
    
                        <img src="__IMG__/money.png" class="moneyimg" alt="..." >
                        <div class="caption">
                                <p class="money">￥{notempty name='$member.bonus'}{$member.bonus}{else /}0.00{/notempty}</p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row wallet">
                        <div class="col-sm-6 col-md-4">
                          <div class="thumbnail">
                                <p><a href="#" class="btn btn-primary" role="button">钻石</a>&nbsp;&nbsp;交易记录</p>
        
                            <img src="__IMG__/money.png" class="moneyimg" alt="..." >
                            <div class="caption">
                                <p class="money">￥{notempty name='$member.price_repeat'}{$member.price}{else /}0.00{/notempty}</p>
                            </div>
                          </div>
                        </div>
                      </div><div class="row wallet">
                            <div class="col-sm-6 col-md-4">
                              <div class="thumbnail">
                                    <p><a href="#" class="btn btn-primary" role="button">VRTC</a>&nbsp;&nbsp;交易记录</p>
            
                                <img src="__IMG__/money.png" class="moneyimg" alt="..." >
                                <div class="caption">
                                        <p class="money">￥{notempty name='$member.price'}{$member.vrtc}{else /}0.00{/notempty}</p>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row wallet">
                                <div class="col-sm-6 col-md-4">
                                  <div class="thumbnail">
                                        <p><a href="#" class="btn btn-primary" role="button">商城币</a>&nbsp;&nbsp;交易记录</p>
                
                                    <img src="__IMG__/money.png" class="moneyimg" alt="..." >
                                    <div class="caption">
                                        <p class="money">￥2000</p>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <!-- <div class="row wallet">
                                    <div class="col-sm-6 col-md-4">
                                      <div class="thumbnail">
                                            <p><a href="#" class="btn btn-primary" role="button">A类产品抵用券</a>&nbsp;&nbsp;交易记录</p>
                    
                                        <img src="__IMG__/money.png" class="moneyimg" alt="..." >
                                        <div class="caption">
                                                <p class="money">￥2000</p>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="row wallet">
                                        <div class="col-sm-6 col-md-4">
                                          <div class="thumbnail">
                                                <p><a href="#" class="btn btn-primary" role="button">车房奖金</a>&nbsp;&nbsp;交易记录</p>
                        
                                            <img src="__IMG__/money.png" class="moneyimg" alt="..." >
                                            <div class="caption">
                                                <p class="money">￥2000</p>
                                            </div>
                                          </div>
                                        </div>
                                      </div> -->
        <!-- 选项组 -->
        <button type="button" class="btn btn-primary other upwallet">升级钱包</button>
        <a href="{:url('index/user/detailed')}"><button type="button" class="btn btn-primary other">奖金明细</button></a>
        <button type="button" class="btn btn-primary other" id='tranfer'>会员转账</button>
        <button type="button" class="btn btn-primary other attc" id="transformation">币币转换</button>
        <!-- 二级选项 -->
        <div class="btn-toolbar btns" role="toolbar" aria-label="...">
                <div class="btn-group" role="group" aria-label="...">
                        <button type="button" class="btn btn-primary secbtn bonus" value="bonus">金币转账</button>
                </div>
                <div class="btn-group" role="group" aria-label="...">
                        <button type="button" class="btn btn-primary secbtn price" value="price">钻石转账</button>
                </div>
                <div class="btn-group" role="group" aria-label="...">
                        <button type="button" class="btn btn-primary secbtn vrtc" value="vrtc">VRTC转账</button>
                </div>
                <div class="btn-group" role="group" aria-label="...">
                        <button type="button" class="btn btn-primary secbtn">商城币转账</button>
                </div>
                <div class="btn-group" role="group" aria-label="...">
                        <button type="button" class="btn btn-primary secbtn">抵用券转账</button>
                </div>
        </div>
    </div>
</div>
<!-- 弹窗 -->
    <div class="middle-box">
        <div class="box-header">
            <span class="span"><b>币币转换</b></span>
            <img src="__IMG__/close2.png" alt="" class="close">
        </div>
        <label for="">转出钱包</label>
        <select class="form-control type">
                <option id="bonus" selected value="bonus">金币</option>
                <option id="price" value="price">钻石</option>
                <option id="vrtc" value="vrtc">VRTC</option>
              </select>
        <label for="">余额</label>
        <input type="text" class="form-control" id="money"  readonly value="{$member.bonus}">
        <label for="">转账余额</label>
        <input type="text" class="form-control" id="tranMoney">
        <label for="">接收钱包</label>
        <select class="form-control receive">
                <option  value="bonus">金币</option>
                <option  value="price">钻石</option>
                <option  value="vrtc">VRTC</option>
              </select>
        <label for="">交易密码</label>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
        <input type="password" class="form-control" id="pay_password" >
        <button type="button" class="btn-yes">确&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;定</button>
        <button type="button" class="btn-no">取&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;消</button>
    </div>

<!-- 升级钱包弹窗 -->
<div class="uplevel-box">
    <div class="box-header">
        <span class="span"><b>钱包升级</b></span>
        <img src="__IMG__/close2.png" alt="" class="close2">
    </div>
    <label for="">购买数量</label>
    <fieldset disabled>
    <select class="form-control upgrade" >
        {if condition="$member.grade==1"}
            <option value="2" selected>一级钱包升二级钱包</option>
        {elseif condition="$member.grade==2"}
            <option value="3" selected>二级钱包升三级钱包</option>
        {else /}
            <option selected>已是最高等级</option>
        {/if}
    </select>
    <label for="">升级费用</label>
    <select class="form-control upnumber" id="disabledSelect">
            {notempty name='$grade.muber'}
            <option value="{$grade.muber}" selected>{$grade.muber}</option>
            {else /}
            <option selected>已是最高等级</option>
            {/notempty}
          </select>
     
    </fieldset>     
          <br>
    <input type="password" class="form-control" id="payPwd" placeholder="支付密码">
    <button type="button" class="btn-uplevel-yes">确&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;定</button>
    <button type="button" class="btn-no">取&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;消</button>
</div>
 
<!-- 升级钱包弹窗 -->
<div class="tranfer-box">
    <div class="box-header">
        <span class="span"><b class="b-span">会员转账</b></span>
        <img src="__IMG__/close2.png" alt="" class="close3">
    </div>
    <label for="">转账金额</label>
    <input type="text" name="tranfer-money" id="tranfer-money" class="form-control">
    <label for="">接收人</label>
    <input type="text" name="receive" id="receive" class="form-control">
    <label for="">支付密码</label>
    <input type="password" class="form-control" id="password" placeholder="支付密码">
    <button type="button" class="btn-tranfer-yes">确&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;定</button>
    <button type="button" class="btn-no">取&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;消</button>
</div>
</body>
<script>
    // 转账点击事件
$('#tranfer').click(function(){
    $('.btns').attr('style','display:block;');
    $('.attc').attr('style','margin-top:63px;');
});
$('#transformation').click(function(){
    
    $('.body-box').attr('style','display:none;');
    $('.middle-box').attr('style','display:block;');
});
$('.close').click(function(){
    $('.body-box').attr('style','display:block;');
    $('.middle-box').attr('style','display:none;'); 
});
    //升级钱包点击事件
$('.upwallet').click(function(){
    $('.body-box').attr('style','display:none;');
    $('.uplevel-box').attr('style','display:block;');
});
$('.close2').click(function(){
    $('.body-box').attr('style','display:block;');
    $('.uplevel-box').attr('style','display:none;');
});
    //转账点击事件
$('.bonus').click(function(){
    $('.body-box').attr('style','display:none;');
    $('.tranfer-box').attr('style','display:block;');
});
$('.price').click(function(){
    $('.body-box').attr('style','display:none;');
    $('.tranfer-box').attr('style','display:block;');
});
$('.vrtc').click(function(){
    $('.body-box').attr('style','display:none;');
    $('.tranfer-box').attr('style','display:block;');
});
$('.close3').click(function(){
    $('.body-box').attr('style','display:block;');
    $('.tranfer-box').attr('style','display:none;');
});
    //选择转账类型
$('.secbtn').click(function(){
    var type=$(this).attr('value');
    switch(type){
        case "bonus":
        $('.head-des').remove();
        $('.b-span').append("<a class='head-des' value='bonus'>（金币）</a>");
        break;
        case "price":
        $('.head-des').remove();
        $('.b-span').append("<a class='head-des' value='price'>（钻石）</a>");
        break;
        case "vrtc":
        $('.head-des').remove();
        $('.b-span').append("<a class='head-des' value='vrtc'>（VRTC）</a>");
        break;
    }
});
// 选择转换类型
$('.type').click(function(){
    var type=$('.type option:selected').val();
    switch(type){
        case "bonus":
        $('#money').attr('value','{$member.bonus}');
        break;
        case "price":
        $('#money').attr('value','{$member.price}');
        break;
        case "vrtc":
        $('#money').attr('value','{$member.vrtc}');
        break;
    }
});
//提交转换
$('.btn-yes').click(function(){
    var type=$('.type option:selected').val();
    var money=$('#money').val();
    var tranMoney=$('#tranMoney').val();
    var pay_password=$('#pay_password').val();
    var receive=$('.receive option:selected').val();
    if(tranMoney==""&&tranMoney==0){
        alert('转换金额不能小于0.1￥');
    }else if(pay_password==""){
        alert('支付密码不能为空');
    }else if(type==receive){
        alert('转换类型不能相同');
    }else if(money<tranMoney){
        alert('转换金额不足');
    }else{
        $.ajax({
            type: "post",
            url: "{:url('index/user/transformationApi')}",
            data: {'type':type,'money':money,'tranMoney':tranMoney,'pay_password':pay_password,"receive":receive},
            success: function (res) {
                alert(res.message);
                if(res.code=="success"){
                    window.location.href="{:url('index/user/wallet')}";
                }
            }
        });
    }
});
//提交转账
$('.btn-tranfer-yes').click(function(){
    var type=$('.head-des').attr('value');
    var tranfer_money=$('#tranfer-money').val();
    var receive=$('#receive').val();
    var password=$('#password').val();
    var conf=confirm('确定转账'+tranfer_money+'给'+receive+'吗');
    if(conf==true){
        if(tranfer_money==""){
        alert('转账金额最低0.1￥');
        }else if(receive==""){
            alert('接收人不能为空');
        }else if(password==""){
            alert('支付密码不能为空');
        }else{
            $.ajax({
                type: "post",
                url: "{:url('index/user/tranApi')}",
                data: {'type':type,'money':tranfer_money,'receive':receive,'password':password},
                success: function (res) {
                    alert(res.message);
                    if(res.code=='success'){
                        window.location.href='{:url("index/user/wallet")}';
                    }
                    
                }
            });
        }
    }  
});
//提交升级钱包
$('.btn-uplevel-yes').click(function(){
    var pwd=$('#payPwd').val();
    if(pwd==""){
        alert('请输入支付密码');
    }else{
        $.ajax({
            type: "post",
            url: "{:url('index/user/upwallet')}",
            data: {"pay_password":pwd},
            success: function (res) {
                alert(res.message);
                if(res.code=='success'){
                    window.location.href="{:url('index/user/wallet')}";
                }
            }
        });
    }
    
});
</script>
</html>